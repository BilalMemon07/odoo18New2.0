<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <!-- Wizard Form view -->
        <record id="view_outstanding_payment_form" model="ir.ui.view">
            <field name="name">outstanding.payment.form</field>
            <field name="model">outstanding.payment</field>
            <field name="arch" type="xml">
                <form string="Reconcile Outstanding Payment">
                    <group>
                        <group>
                            <field name="move_type" invisible="1"/>
                            <field name="partner_id" string="Customer" force_save="True" invisible="move_type not in ['out_invoice','out_refund']"/>
                            <field name="partner_id" string="Vendor" force_save="True" invisible="move_type not in ['in_refund','in_invoice']"/>
                        </group>
                    </group>
                    <!-- NOTE BELOW-->
                    <!--
                     - Outstanding credits in invoice(out_invoice) and vendor_credit_note(in_refund)
                     - Outstanding debits in bill(in_invoice) and customer credit_note(out_refund)
                    -->
                    <!-- -->
                    <div>
                        <h2>
                            <span invisible="move_type not in ['in_refund','out_invoice']">Outstanding credits</span>
                            <span invisible="move_type not in ['out_refund','in_invoice']">Outstanding debits</span>
                        </h2>
		        	    <field name="outstanding_payment_ids">
		        	        <list create="false" editable="bottom">
		        	            <field name="state" column_invisible="1"/>
		        	            <field name="select_to_pay"/><!-- widget="boolean_toggle"-->
		        	            <field name="name"/>
		        	            <field name="date" optional="show" force_save="1"/>
		        	            <field name="ref" optional="show"/>
		        	            <field name="move_id" optional="show"/>
		        	            <field name="amount"/>
		        	            <field name="amount_due" sum="Total"/>
		        	            <field name="is_payment" optional="show"/>
		        	            <field name="is_invoice" string="Credit Note" column_invisible="parent.move_type != 'out_invoice'"/>
		        	            <field name="is_invoice" string="Invoice" column_invisible="parent.move_type != 'out_refund'"/>
		        	            <field name="is_invoice" string="Refunds" column_invisible="parent.move_type != 'in_invoice'"/>
		        	            <field name="is_invoice" string="Bill" column_invisible="parent.move_type != 'in_refund'"/>
		        	            <field name="account_payment_id" column_invisible="1"/>
		        	            <field name="account_move_id" column_invisible="1"/>
		        	        </list>
		        	    </field>
		        	</div>
                    <div>
                        <h2>
                            <!--span>Invoice/Bill Details</span-->
                            <span invisible="move_type != 'out_invoice'">To be reconcile with below Invoices</span>
                            <span invisible="move_type != 'out_refund'">To be reconcile with below Customer Credit Notes</span>
                            <span invisible="move_type != 'in_invoice'">To be reconcile with below Bills</span>
                            <span invisible="move_type != 'in_refund'">To be reconcile with below Vendor Credit Notes</span>
                        </h2>
			            <field name="outstanding_move_ids">
			                <list create="false" editable="bottom">
			                    <field name="select_to_pay"/><!--  widget="boolean_toggle"-->
			                    <field name="name"/>
			                    <field name="account_move_id" column_invisible="1"/>
			                    <field name="ref" optional="show"/>
			                    <field name="company_id" column_invisible="1"/>
			                    <field name="invoice_date"/>
			                    <field name="due_date" optional="show"/>
			                    <field name="amount_untaxed" optional="hide"/>
			                    <field name="amount_total" sum="Total"/>
			                    <field name="amount_residual" sum="Total"/>
			                    <field name="paid_amount"/>
			                    <field name="state" column_invisible="1"/>
			                    <field name="move_id" column_invisible="1"/>
			                </list>
			            </field>
			            
			        <group class="oe_right">
			            <field name="to_be_paid_amount"/>
			        </group>
	                
			        </div>
	                <footer>
                        <button string='Reconcile Payment' name="reconcile_payment" type="object" class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                        
	                </footer>
               </form>
            </field>
        </record>
        
        <record id="action_outstanding_payment" model="ir.actions.act_window">
            <field name="name">Reconcile Outstanding Payment</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">outstanding.payment</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="groups_id" eval="[(4, ref('reconcile_outstanding_payment_omax.group_reconcile_payment'))]"/>
            <field name="binding_model_id" ref="account.model_account_move"/>
        </record>
    </data>
</odoo>
